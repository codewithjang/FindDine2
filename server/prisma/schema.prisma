generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

model restaurant {
  id               Int             @id @default(autoincrement())
  address          String
  phone            String
  description      String?
  createdAt        DateTime        @default(now())
  updatedAt        DateTime        @default(now()) @updatedAt
  openTime         String?         @db.VarChar(10)
  closeTime        String?         @db.VarChar(10)
  isBookingOpen    Boolean         @default(true)
  email            String          @unique(map: "Restaurant_email_key")
  facilities       String?         @db.LongText
  foodType         String
  latitude         Float?
  lifestyles       String?         @db.LongText
  locationStyles   String?         @db.LongText
  longitude        Float?
  nearbyPlaces     String?
  password         String
  paymentOptions   String?         @db.LongText
  photos           String?         @db.LongText
  priceRange       String?         @db.VarChar(50)
  restaurantName   String
  serviceOptions   String?         @db.LongText
  startingPrice    Int?
  bookingSettingId Int?
  createdByAdminId String?         @db.VarChar(255)
  viewCount        Int             @default(0)
  booking          booking[]
  bookingsetting   bookingsetting?
  review           review[]        @relation("RestaurantReviews")

  @@map("restaurant")
}

model booking {
  id              Int        @id @default(autoincrement())
  restaurantId    Int
  date            DateTime   @db.DateTime(0)
  time            String     @db.VarChar(10)
  guests          Int
  customerName    String     @db.VarChar(100)
  customerPhone   String     @db.VarChar(30)
  customerEmail   String?    @db.VarChar(100)
  specialRequests String?    @db.Text
  createdAt       DateTime?  @default(now()) @db.DateTime(0)
  updatedAt       DateTime?  @default(now()) @db.DateTime(0)
  status          String     @default("pending")
  restaurant      restaurant @relation(fields: [restaurantId], references: [id], onDelete: Cascade, onUpdate: Restrict, map: "fk_booking_restaurant")

  @@index([restaurantId], map: "fk_booking_restaurant")
}

model bookingsetting {
  id             Int         @id @default(autoincrement())
  restaurantId   Int?        @unique(map: "restaurantId")
  allowBooking   Boolean?    @default(true)
  maxGuests      Int?        @default(10)
  tableCount     Int?        @default(10)
  advanceDays    Int?        @default(30)
  holdMinutes    Int?        @default(15)
  cancelBeforeHr Int?        @default(2)
  openTime       String      @db.VarChar(10)
  closeTime      String      @db.VarChar(10)
  policyNotes    String?     @db.Text
  createdAt      DateTime?   @default(now()) @db.DateTime(0)
  updatedAt      DateTime?   @default(now()) @db.DateTime(0)
  restaurant     restaurant? @relation(fields: [restaurantId], references: [id], onDelete: Cascade, onUpdate: Restrict, map: "fk_restaurant_booking")
}

model review {
  id           Int        @id @default(autoincrement())
  restaurantId Int
  name         String     @db.VarChar(255)
  email        String?    @db.VarChar(255)
  rating       Float      @db.Float
  comment      String     @db.Text
  createdAt    DateTime?  @default(now()) @db.DateTime(0)
  restaurant   restaurant @relation("RestaurantReviews", fields: [restaurantId], references: [id], onDelete: Cascade, onUpdate: Restrict, map: "fk_review_restaurant")

  @@index([restaurantId], map: "fk_review_restaurant_fix")
}

model user {
  id        Int      @id @default(autoincrement())
  firstName String
  lastName  String
  email     String   @unique(map: "User_email_key")
  password  String
  createdAt DateTime @default(now())
  updatedAt DateTime
}

model admin {
  id        Int       @id @default(autoincrement())
  email     String    @unique(map: "email") @db.VarChar(255)
  password  String    @db.VarChar(255)
  name      String?   @db.VarChar(255)
  createdAt DateTime? @default(now()) @db.DateTime(0)
}
